<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GiftyBox</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Загрузочный экран -->
    <div id="loading-screen">
        <canvas id="star-canvas"></canvas>
        <h1>GiftyBox - выигрывай подарки</h1>
    </div>
    <!-- Новый layout под референс -->
    <div id="app">
        <!-- Верхняя панель -->
        <header class="top-bar">
            <div class="logo"><img src="assets/nft/basic-teddybear.gif" alt="logo"/></div>
            <button class="btn-wallet" id="btn-connect-wallet">Connect wallet</button>
            <div class="balance-row">
                <span id="main-balance">0.00</span>
                <img src="assets/ton-logo.svg" class="ton-logo"/>
            </div>
            <div class="profile-avatar-mini"><img src="assets/nft/mythic-neko-helmet.gif" alt="avatar"/></div>
        </header>
        <!-- Страницы -->
        <main>
            <!-- Main -->
            <section id="page-main" class="page active">
                <div class="main-menu">
                    <a href="https://t.me/Ytouy_Official" target="_blank" class="main-btn telegram-btn">
                        Присоединяйся к нашему телеграмм каналу
                    </a>
                    <button class="main-btn cases-btn" onclick="showPage('cases')">
                        Открывай кейсы и испытывай удачу
                    </button>
                    <button class="main-btn upgrade-btn" onclick="showPage('upgrade')">
                        Используй апгрейд для улучшения подарков
                    </button>
                </div>
            </section>
            <!-- Cases -->
            <section id="page-cases" class="page">
                <div class="cases-balance-row">
                    <!-- Горизонтальный список баланса по кейсам -->
                </div>
                <div class="cases-list" id="cases-list-grid">
                    <!-- Кейсы будут рендериться динамически через JS -->
                </div>
            </section>
            <!-- Case Detail -->
            <section id="page-case-detail" class="page">
                <div class="case-detail-header">
                    <div id="case-detail-avatar" class="case-detail-avatar"></div>
                    <h2 id="case-detail-title" class="case-detail-title"></h2>
                    <div class="case-detail-price">
                        <span id="case-detail-price">0.00</span>
                        <img src="assets/ton-logo.svg" class="ton-logo"/>
                    </div>
                </div>
                <div id="case-detail-prizes-grid" class="case-detail-prizes"></div>
            </section>
            <!-- Deposit -->
            <section id="page-deposit" class="page">
                <div class="deposit-block">
                    <button class="btn-wallet" id="btn-connect-wallet-2">Connect wallet</button>
                    <div class="deposit-balance">0.00 <img src="assets/ton-logo.svg"/></div>
                    <button class="btn btn-blue">Deposit</button>
                </div>
                <div id="ton-connect-modal" class="modal hidden">
                    <div class="modal-content">
                        <h3>Connect your TON wallet</h3>
                        <div class="qr-code"></div>
                        <div class="wallets-list">
                            <!-- Список кошельков -->
                        </div>
                    </div>
                </div>
            </section>
            <!-- Upgrade -->
            <section id="page-upgrade" class="page">
                <div class="upgrade-history-row">
                    <!-- История апгрейдов -->
                </div>
                <div class="upgrade-switch">
                    <button class="tab active">Gifts</button>
                    <button class="tab">TONs</button>
                </div>
                <div class="upgrade-circle">
                    <div class="upgrade-center">UPGRADE<br><span>Select prize</span></div>
                </div>
                <div class="upgrade-inventory-row">
                    <!-- Инвентарь для апгрейда -->
                </div>
            </section>
            <!-- Profile -->
            <section id="page-profile" class="page">
                <div class="profile-header">
                    <div class="profile-avatar"><img src="assets/nft/mythic-neko-helmet.gif" alt="avatar"></div>
                    <div class="profile-info">
                        <div class="profile-nick" id="profile-name"></div>
                        <div class="profile-balance">
                            <span id="profile-balance">0.00</span>
                            <img src="assets/ton-logo.svg"/>
                        </div>
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="btn btn-blue" onclick="showPage('deposit')">Пополнить</button>
                    <button class="btn btn-grey" onclick="window.Telegram.WebApp.openTelegramLink('https://t.me/giftybox_support')">Поддержка</button>
                </div>
                <div id="inventory-list" class="profile-inventory">
                    <div class="empty-inventory">В вашем инвентаре пока ничего нет<br><button class="btn btn-blue" onclick="showPage('cases')">Открыть кейс</button></div>
                </div>
            </section>
            <!-- Case Opening -->
            <section id="page-case-opening" class="page">
                <div class="case-header">
                    <img src="" alt="Case" id="case-avatar" class="case-avatar">
                    <div class="case-name" id="case-name"></div>
                    <div class="case-price">
                        <span id="case-price">0.00</span>
                        <img src="assets/ton-logo.svg" class="ton-logo"/>
                    </div>
                </div>
                <!-- КНОПКИ ПОД ЦЕНОЙ -->
                <div class="case-spin-controls">
                    <button class="btn btn-blue btn-spin" id="btn-spin-case">Spin</button>
                    <button class="btn btn-grey btn-demo" id="btn-demo-case">Demo spin</button>
                    <div class="spin-options">
                        <label class="fast-option">
                            <input type="checkbox" id="fast-spin">
                            <span>Fast</span>
                        </label>
                        <div class="multiplier-options">
                            <button class="btn-mult active" data-mult="x1">x1</button>
                            <button class="btn-mult" data-mult="x2">x2</button>
                            <button class="btn-mult" data-mult="x3">x3</button>
                            <button class="btn-mult" data-mult="x4">x4</button>
                            <button class="btn-mult" data-mult="x5">x5</button>
                        </div>
                    </div>
                </div>
                <!-- КОНЕЦ КНОПОК -->
                <div class="case-spinner">
                    <div class="spinner-container">
                        <div class="spinner-items" id="spinner-items"></div>
                        <div class="spinner-pointer"></div>
                    </div>
                </div>
                <div class="case-items">
                    <h3>Возможные призы</h3>
                    <div class="items-grid" id="possible-items"></div>
                </div>
            </section>
        </main>
        <!-- Нижнее меню -->
        <nav class="bottom-nav">
            <button class="nav-btn" data-page="main" onclick="showPage('main')">
                <span class="nav-icon"><img src="assets/icons/main.svg" alt="Main" width="28" height="28"></span><span>Main</span>
            </button>
            <button class="nav-btn" data-page="cases" onclick="showPage('cases')">
                <span class="nav-icon"><img src="assets/icons/cases.svg" alt="Cases" width="28" height="28"></span><span>Cases</span>
            </button>
            <button class="nav-btn" data-page="deposit" onclick="showPage('deposit')">
                <span class="nav-icon"><img src="assets/icons/deposit.svg" alt="Deposit" width="28" height="28"></span><span>Deposit</span>
            </button>
            <button class="nav-btn" data-page="upgrade" onclick="showPage('upgrade')">
                <span class="nav-icon"><img src="assets/icons/upgrade.svg" alt="Upgrade" width="28" height="28"></span><span>Upgrade</span>
            </button>
            <button class="nav-btn" data-page="profile" onclick="showPage('profile')">
                <span class="nav-icon"><img src="assets/icons/profile.svg" alt="Profile" width="28" height="28"></span><span>Profile</span>
            </button>
        </nav>
    </div>
    <!-- Контейнер для TON Connect UI -->
    <div id="ton-connect-ui" style="margin-bottom: 18px;"></div>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tma.js/sdk@latest/dist/tma.js"></script>
    <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="nft-prices.js"></script>
    <script src="script.js"></script>
</body>
</html>